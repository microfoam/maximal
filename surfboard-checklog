#!/bin/bash

FILE="Surf_wavereport.log"     
if [ -f $FILE ]; then
	echo 'Surf wave report summary: '
	echo '._M                                                                                                                           '
	echo '\\\_P                                                                                                                         '
	echo '\\\\\_G                                                                                            \v/                        '
	echo '\\\\\\\_A_________.~~.o.~"~._.~`"~._.~"~._.~"~._.~"~._.~`"~._.~"~._.~"~._^_.~"~._.~"~._.~"~._.~`"~.-0-.~"~._.~"~._.~"~._.~"~._'
	echo '```````^:^````````                                                                                 /|\                        '
	echo 'First and last runs:'
	head -n 1 $FILE
	tail -n 1 $FILE
	echo
	echo 'Number of tests initiated:         ' | tr -d "\n"
	grep -c waves $FILE
	echo 'Number of tests completed:         ' | tr -d "\n"
	grep -cE '^v' $FILE
	echo 'Number of tests w/ PASS 1000:      ' | tr -d "\n"
	grep -cE 'P:1000' $FILE
	echo 'Number of tests w/ REC. 1000:      ' | tr -d "\n"
	grep -cE 'R:1000' $FILE 
	echo
	echo 'Tests canceled (if any, w/ preceding run for context):'
	grep -B1 Canceled $FILE | sed '/^--$/d'
	echo 'Tests with PASS < 1000 (if any):'
	grep ^v $FILE | grep -vE 'P:1000' 
	echo 'Tests with REC. < 1000 (if any):'
	grep ^v $FILE | grep -vE 'R:1000' 
	echo
	awk -F'[\t]' '{sum+=$4} END {print "WCR-t average: " sum/NR}' $FILE 
	awk -F'[\t]' '{sum+=$5} END {print "WCR-k average: " sum/NR}' $FILE 
	awk -F'[\t]' '{sum+=$6} END {print "WCR-d average: " sum/NR}' $FILE 
	echo
else
	echo
	echo "$0: File $FILE must first be generated by running one of the cleanup_set scripts."
	echo
fi


