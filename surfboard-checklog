#!/bin/bash

FILE="Surf_wavereport.log"     
if [ -f $FILE ]; then
	echo 'Surf wave report summary: '
	echo '._                                                                                                                            '
	echo '\\\_M                                                                                                                         '
	echo '\\\\\_H                                                                                            \v/                        '
	echo '\\\\\\\_A_________.~~.o.~"~._.~`"~._.~"~._.~"~._.~"~._.~`"~._.~"~._.~"~._^_.~"~._.~"~._.~"~._.~`"~.-0-.~"~._.~"~._.~"~._.~"~._'
	echo '```````^:^````````                                                                                 /|\                        '
	echo 'First and last runs:'
	head -n 1 $FILE
	tail -n 1 $FILE
	echo
	echo 'Number of tests initiated:         ' | tr -d "\n"
	grep -c waves $FILE
	echo 'Number of tests completed:         ' | tr -d "\n"
	grep -cE '^v' $FILE
	echo 'Number of tests w/ PASS 1000:      ' | tr -d "\n"
	grep -cE '\t1000' $FILE 
	echo 'Number of tests w/ REC. 1000:      ' | tr -d "\n"
	grep -cE 'C.1000' $FILE 
	echo 'Number of tests w/ nudging:        ' | tr -d "\n"
	grep -cE -v 'NDG: 0' $FILE
	echo
	awk -F'[\t]' '{sum+=$5} END {print "WCR average: " sum/NR}' $FILE 
	echo
	echo 'Tests canceled (if any, w/ preceding run for context):'
	grep -B1 Canceled $FILE | sed '/^--$/d'
	echo 'Tests with PASS < 1000 (if any):'
	grep ^v $FILE | grep -vE '\t1000' 
	echo 'Tests with REC. < 1000 (if any):'
	grep ^v $FILE | grep -vE 'REC:1000' 
	echo 'Tests with nudging (if any):'
	grep ^v $FILE | grep -vE 'NDG: 0' 
	echo
	echo 'Line counts:'
	wc -l src/*.c src/*.h
	echo
else
	echo
	echo "$0: File $FILE must first be generated by running one of the cleanup_set scripts."
	echo
fi


